<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Crypto Journal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { background-color: #f8fafc; font-family: -apple-system, system-ui, sans-serif; }
        .card { background: white; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
    </style>
</head>
<body class="p-4 pb-20">

    <header class="mb-6">
        <h1 class="text-2xl font-bold text-gray-800">ğŸ“Š äº¤æ˜“å¾©ç›¤ç´€éŒ„</h1>
    </header>

    <section class="card p-5 mb-8">
        <div class="space-y-4">
            <div>
                <label class="block text-sm font-medium">äº¤æ˜“æ—¥æœŸ</label>
                <input type="date" id="date" class="mt-1 block w-full rounded-md border p-2">
            </div>
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium">å¹£ç¨®</label>
                    <select id="coin" class="mt-1 block w-full rounded-md border p-2">
                        <option>BTC</option><option>ETH</option><option>SOL</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium">ç­–ç•¥</label>
                    <select id="strategy" class="mt-1 block w-full rounded-md border p-2">
                        <option>çªç ´è¿½å¤š</option><option>å›è¸©åšå¤š</option><option>éœ‡ç›ªé«˜ç©º</option>
                    </select>
                </div>
            </div>
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium">é‡‘é¡ (USD)</label>
                    <input type="number" id="amount" class="mt-1 block w-full rounded-md border p-2">
                </div>
                <div>
                    <label class="block text-sm font-medium">æç›Š (USD)</label>
                    <input type="number" id="pnl" class="mt-1 block w-full rounded-md border p-2">
                </div>
            </div>
            <button onclick="saveRecord()" class="w-full bg-black text-white py-3 rounded-xl font-bold active:bg-gray-800">å„²å­˜ç´€éŒ„</button>
        </div>
    </section>

    <section class="card p-5 mb-8">
        <h2 class="text-lg font-semibold mb-4">ç­–ç•¥æç›Šçµ±è¨ˆ</h2>
        <canvas id="strategyChart"></canvas>
    </section>

    <section class="card p-5">
        <h2 class="text-lg font-semibold mb-4">æ­·å²ç´€éŒ„</h2>
        <div id="historyList" class="space-y-2 text-sm"></div>
        <button onclick="clearData()" class="mt-4 text-red-500 text-xs">æ¸…é™¤æ‰€æœ‰è³‡æ–™</button>
    </section>

    <script>
        let myRecords = JSON.parse(localStorage.getItem('crypto_logs')) || [];
        let chart;

        // åˆå§‹åŒ–
        window.onload = function() {
            renderHistory();
            updateChart();
            document.getElementById('date').valueAsDate = new Date();
        };

        function saveRecord() {
            const record = {
                date: document.getElementById('date').value,
                coin: document.getElementById('coin').value,
                strategy: document.getElementById('strategy').value,
                amount: parseFloat(document.getElementById('amount').value) || 0,
                pnl: parseFloat(document.getElementById('pnl').value) || 0
            };

            myRecords.push(record);
            localStorage.setItem('crypto_logs', JSON.stringify(myRecords));
            
            alert('å„²å­˜æˆåŠŸï¼');
            renderHistory();
            updateChart();
        }

        function renderHistory() {
            const list = document.getElementById('historyList');
            list.innerHTML = myRecords.map(r => 
                `<div class="border-b pb-1">ğŸ“… ${r.date} | ${r.coin} | ${r.strategy} | <span class="${r.pnl >= 0 ? 'text-green-500' : 'text-red-500'}">${r.pnl}</span></div>`
            ).reverse().join('');
        }

        function updateChart() {
            const summary = {};
            myRecords.forEach(r => {
                summary[r.strategy] = (summary[r.strategy] || 0) + r.pnl;
            });

            const ctx = document.getElementById('strategyChart').getContext('2d');
            if (chart) chart.destroy();
            chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(summary),
                    datasets: [{
                        label: 'æç›ŠåŠ ç¸½',
                        data: Object.values(summary),
                        backgroundColor: '#6366f1'
                    }]
                }
            });
        }

        function clearData() {
            if(confirm('ç¢ºå®šè¦åˆªé™¤æ‰€æœ‰ç´€éŒ„å—ï¼Ÿ')) {
                localStorage.removeItem('crypto_logs');
                location.reload();
            }
        }
    </script>
</body>
</html>
